---
- name: Asegura que la maquina esté registrada
  community.general.redhat_subscription:
    state: present
    username: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          64303730373239363131613833376634323834383034393464303163303730656130633633323563
          6235373331366234666362336231633638313532623539310a626337333233306664303230656163
          33656638326135306664373632313731306635643464303036303839616132356266316637396636
          3035383539386232610a376238373232393233336163613361366661333262363961306165366665
          30353262383835353830656665336665373463633930333665633263626166643461
    password: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          34386136326164633561356466393031666466353731663034393433336563393762643730306539
          6532323135653431363266373236333833323863353166610a313564616538656637323364653130
          62343461326334666662653564346462653534396162323163653939613932363334343765396664
          3235303932323133380a623763326231323739336666643734323664366363323435656361343331
          3863
  tags:
    - registration
    
- name: Registrar con Insights
  ansible.builtin.include_role:
    name: redhat.insights.insights_client
  tags:
    - registration
    
- name: Asegura que la convención de nombre del equipo se cumpla
  ansible.builtin.fail:
  when: ansible_hostname is not regex('[-a-z\d]+')
...
